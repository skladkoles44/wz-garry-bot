‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤. –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è (TOKEN, ADMIN_ID, DB_URL, WEBHOOK_SECRET) —É–∫–∞–∑–∞–Ω—ã –∫–∞–∫ –ø—Ä–∏–º–µ—Ä—ã. –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ .env, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –∏ –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è.

# üß† WZ Garry Bot ‚Äî –ü–æ–ª–Ω—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–∞—Å–ø–æ—Ä—Ç

## 1. –û–±—â–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è
**–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:** `WZ Garry Bot`  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Telegram-–±–æ—Ç –¥–ª—è WZ-—Å–∏—Å—Ç–µ–º (–ø–æ–º–æ—â–Ω–∏–∫/–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è).  
**–Ø–∑—ã–∫:** Node.js (v20.19.5)  
**–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞:** [Telegraf](https://telegraf.js.org/)  
**–ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ—Ü–µ—Å—Å–æ–≤:** [PM2](https://pm2.keymetrics.io/)  
**–•—Ä–∞–Ω–∏–ª–∏—â–µ –∫–æ–¥–∞:** [GitHub ‚Äî skladkoles44/wz-garry-bot](https://github.com/skladkoles44/wz-garry-bot)  
**–°–µ—Ä–≤–µ—Ä:** VPS `89.111.171.170`, –û–° Linux Ubuntu 22+  
**–ü—É—Ç—å –ø—Ä–æ–µ–∫—Ç–∞:** `/root/wz-garry-bot`  
**–ó–∞–ø—É—Å–∫:** `pm2 start src/index.js --name wz-garry`

---

## 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

/root/wz-garry-bot/ ‚îú‚îÄ‚îÄ src/                 # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ (–ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞) ‚îÇ   ‚îî‚îÄ‚îÄ index.js ‚îú‚îÄ‚îÄ deploy/              # –°–µ–∫—Ä–µ—Ç—ã, —à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã ‚îÇ   ‚îî‚îÄ‚îÄ .env.prod.enc ‚îú‚îÄ‚îÄ docs/                # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ ‚îÇ   ‚îî‚îÄ‚îÄ security_plan_v1.5.7.md ‚îú‚îÄ‚îÄ stages/              # –≠—Ç–∞–ø—ã –≤–Ω–µ–¥—Ä–µ–Ω–∏—è ‚îú‚îÄ‚îÄ scripts/             # –°–∫—Ä–∏–ø—Ç—ã (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è, –¥–µ–ø–ª–æ–π) ‚îú‚îÄ‚îÄ package.json         # Node-–ø–∞–∫–µ—Ç—ã –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ ‚îú‚îÄ‚îÄ .sops.yaml           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è ‚îú‚îÄ‚îÄ .env                 # –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π .env (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å!) ‚îî‚îÄ‚îÄ README.md

---

## 3. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

TOKEN=<—Å–º. —Ñ–∞–π–ª .env>

---

## 4. –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```bash
npm init -y
npm i telegraf dotenv
npm i -D eslint jest husky
npx husky init


---

5. GitHub –∏ CI/CD

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: git@github.com:Skladkoles44/wz-garry-bot.git

Workflow: .github/workflows/ci.yml

–≠—Ç–∞–ø—ã: lint ‚Üí test ‚Üí build Docker ‚Üí deploy SSH


Secrets –≤ GitHub:

VPS_HOST

VPS_USER

SSH_KEY

SOPS_AGE_KEY




---

6. –î–µ–ø–ª–æ–π –Ω–∞ VPS

git pull
npm ci
pm2 restart wz-garry
pm2 save


---

7. –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫

pm2 startup
pm2 save
systemctl status pm2-root


---

8. PM2 —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

–î–µ–π—Å—Ç–≤–∏–µ	–ö–æ–º–∞–Ω–¥–∞

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã	pm2 list
–õ–æ–≥–∏	pm2 logs wz-garry --lines 30
–†–µ—Å—Ç–∞—Ä—Ç	pm2 restart wz-garry
–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å	pm2 stop wz-garry
–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫	pm2 save && pm2 startup



---

9. Telegram API –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

. ./.env
curl -s "https://api.telegram.org/bot${TOKEN}/getMe"
curl -s "https://api.telegram.org/bot${TOKEN}/getWebhookInfo"
curl -s "https://api.telegram.org/bot${TOKEN}/getUpdates"


---

10. –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (SOPS / age)

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è .sops.yaml

creation_rules:
  - path_regex: deploy/\.env\.prod\.enc$
    age: ["age1p3zxpcu6jgc2gjht53xtmusx8kln4ptcqewzl3s25ur4cfw8nf0su3cr53"]

–ö–ª—é—á–∏

–ü—É—Ç—å –∫ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º—É –∫–ª—é—á—É: /root/.config/sops/age/keys.txt

–§–æ—Ä–º–∞—Ç:

# created: 2024-10-30
# public key: age1p3zxpc...
AGE-SECRET-KEY-1YFZ...


–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞

export SOPS_AGE_KEY_FILE=~/.config/sops/age/keys.txt
sops -d deploy/.env.prod.enc > .env

–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

sops -e --age "age1p3zxpc..." .env > deploy/.env.prod.enc


---

11. –ö–ª—é—á–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–¢–∏–ø	–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ	–ó–∞—â–∏—Ç–∞

age private	/root/.config/sops/age/keys.txt	chmod 600
.env	/root/wz-garry-bot/.env	chmod 600
pm2 logs	/root/.pm2/logs/	‚Äî
systemd unit	/etc/systemd/system/pm2-root.service	root



---

12. GPG (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ age)

gpg --full-generate-key
gpg --armor --export KEY_ID > public.gpg
sops -e --pgp KEY_ID .env > deploy/.env.prod.enc


---

13. –†–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π

1. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π –∫–ª—é—á.


2. –î–æ–±–∞–≤–∏—Ç—å public –≤ .sops.yaml.


3. –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –∏ –ø–µ—Ä–µ—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã.


4. –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π –∫–ª—é—á –∏–∑ .sops.yaml.


5. –£–¥–∞–ª–∏—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á —Å–æ —Å—Ç–∞—Ä—ã—Ö –º–∞—à–∏–Ω.




---

14. CI/CD —Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º

- name: Decrypt secrets
  run: |
    echo "${{ secrets.SOPS_AGE_KEY }}" > ~/.config/sops/age/keys.txt
    sops -d deploy/.env.prod.enc > .env


---

15. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–õ–æ–≥–∏: pm2 logs wz-garry

Uptime: pm2 describe wz-garry | grep uptime

–ó–∞–≥—Ä—É–∑–∫–∞: pm2 monit



---

16. –í–µ–±—Ö—É–∫–∏ (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ polling)

await bot.telegram.setWebhook('https://bot.example.com/telegraf/SECRET');
bot.startWebhook('/telegraf/SECRET', null, 3000);


---

17. Nginx + SSL

/etc/nginx/sites-available/wz-garry-bot.conf

server {
  listen 443 ssl;
  server_name bot.example.com;
  ssl_certificate /etc/letsencrypt/live/bot.example.com/fullchain.pem;
  ssl_certificate_key /etc/letsencrypt/live/bot.example.com/privkey.pem;

  location /telegraf/ {
    proxy_pass http://127.0.0.1:3000/telegraf/;
  }
}


---

18. –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

–ö–æ–º–∞–Ω–¥–∞	–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

/start	–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
/ping	–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏
/help	–°–ø—Ä–∞–≤–∫–∞



---

19. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É

const ADMIN_ID = process.env.ADMIN_ID;
const notify = (t) => bot.telegram.sendMessage(ADMIN_ID, t);
notify('üöÄ Bot started');


---

20. –ü–ª–∞–Ω –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è

–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π —Ä–µ—Å—Ç–∞—Ä—Ç: crontab -e

0 4 * * 1 pm2 restart wz-garry

–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π: npm outdated, npm audit fix

–ë—ç–∫–∞–ø –∫–ª—é—á–µ–π: /root/.config/sops/age/keys.txt (–æ—Ñ–ª–∞–π–Ω –∫–æ–ø–∏—è)



---

21. –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏

–≠–ª–µ–º–µ–Ω—Ç	–ü—É—Ç—å

–ü—Ä–æ–µ–∫—Ç	/root/wz-garry-bot
–õ–æ–≥–∏	/root/.pm2/logs/
–ö–ª—é—á–∏	/root/.config/sops/age/keys.txt
.env	/root/wz-garry-bot/.env
systemd	/etc/systemd/system/pm2-root.service



---

22. –ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

pm2 status
pm2 logs wz-garry --lines 50
cd /root/wz-garry-bot
git pull && npm ci && pm2 restart wz-garry
. ./.env && curl -s "https://api.telegram.org/bot${TOKEN}/getMe"
systemctl status pm2-root


---

23. –ö–æ–Ω—Ç—Ä–æ–ª—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

Root-–¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –ø–æ SSH-–∫–ª—é—á—É.

.env –∏ –∫–ª—é—á–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ root.

–°–µ–∫—Ä–µ—Ç—ã –Ω–µ –∫–æ–º–º–∏—Ç—è—Ç—Å—è.

deploy/.env.prod.enc ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª.

PM2 –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω—ã.



---

24. –°–∫—Ä–∏–ø—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

#!/bin/bash
cd /root/wz-garry-bot
git pull
npm ci
pm2 restart wz-garry
pm2 save
echo "‚úÖ Bot updated at $(date)"


---

25. –ö–æ–Ω—Ç—Ä–æ–ª—å –≤–µ—Ä—Å–∏–π –∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ git.

–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è .env –∏ –∫–ª—é—á–µ–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –æ—Ñ–ª–∞–π–Ω.

–í–æ–∑–º–æ–∂–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å GitHub Releases.



---

26. –ú–µ—Ç–æ–¥—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

–ú–µ—Ç–æ–¥	–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è	–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

age	‚úÖ	–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π, –ø—Ä–æ—Å—Ç–æ–π, –±—ã—Å—Ç—Ä—ã–π
GPG	‚öôÔ∏è (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)	–ü–æ–¥–¥–µ—Ä–∂–∫–∞ PGP-–∫–ª—é—á–µ–π
AWS KMS / GCP KMS	üèóÔ∏è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)	–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞–º–∏
SOPS	‚úÖ	–û–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ age/GPG/KMS –¥–ª—è —Ñ–∞–π–ª–æ–≤



---

27. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞–º–∏

–ö–ª—é—á–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∫–æ–º–∞–Ω–¥–æ–π age-keygen -o ~/.config/sops/age/keys.txt

–ü—É–±–ª–∏—á–Ω—ã–µ –∫–ª—é—á–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ .sops.yaml

–ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ ‚Äî —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö

–†–æ—Ç–∞—Ü–∏—è: –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π public ‚Üí –ø–µ—Ä–µ—à–∏—Ñ—Ä–æ–≤–∞—Ç—å ‚Üí —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π

–†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –∫–ª—é—á–µ–π ‚Äî –≤ –æ—Ñ–ª–∞–π–Ω-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ



---

28. –ü—Ä–æ–≤–µ—Ä–∫–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

sops -d --list-keys deploy/.env.prod.enc


---

29. –†–æ—Ç–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤

1. –ù–æ–≤—ã–π –∫–ª—é—á ‚Üí –¥–æ–±–∞–≤–∏—Ç—å –≤ .sops.yaml


2. –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å .env.prod.enc


3. –ü–µ—Ä–µ—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–º –∫–ª—é—á–æ–º


4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env –ø–æ—Å–ª–µ –¥–µ—à–∏—Ñ—Ä–æ–≤–∫–∏


5. –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π –∫–ª—é—á




---

30. –ò—Ç–æ–≥–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç	–ü—É—Ç—å	–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç	/root/wz-garry-bot	–ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
–õ–æ–≥–∏	/root/.pm2/logs/	Runtime-–ª–æ–≥–∏
–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á	/root/.config/sops/age/keys.txt	–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤
Unit-—Ñ–∞–π–ª	/etc/systemd/system/pm2-root.service	–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫
PM2 dump	/root/.pm2/dump.pm2	–°–ø–∏—Å–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
–®–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π .env	deploy/.env.prod.enc	–•—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤
–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π .env	.env	–†–∞–±–æ—á–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ



---

31. –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ Telegram
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–µ–π SOPS
‚úÖ –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ PM2 –∞–∫—Ç–∏–≤–µ–Ω
‚úÖ Backup –∫–ª—é—á–µ–π —Å–æ—Ö—Ä–∞–Ω—ë–Ω
‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã (npm ci)
‚úÖ –õ–æ–≥–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã (pm2 logs)


---

> –î–æ–∫—É–º–µ–Ω—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω: –ú–∞–Ω—É–∞–ª –ø–æ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ WZ Garry Bot
–ê–≤—Ç–æ—Ä: @wheelrimzone
–î–∞—Ç–∞: 2025-10-30
–§–æ—Ä–º–∞—Ç: Markdown (.md)
–í–µ—Ä—Å–∏—è: 1.0 EOF

---

## 32. –ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–º–º–∏—Ç–æ–≤ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (Husky)
–í –ø—Ä–æ–µ–∫—Ç–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã git-—Ö—É–∫–∏ **Husky**:
- **pre-commit** –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ–ø–∞–¥–∞–Ω–∏–µ `.env`, `*.enc`, `keys.txt`, –∏—â–µ—Ç —Å–∏–≥–Ω–∞—Ç—É—Ä—ã —Ç–æ–∫–µ–Ω–æ–≤, –∑–∞–ø—É—Å–∫–∞–µ—Ç ESLint –∏ (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏) —Ç–µ—Å—Ç—ã.
- **prepare-commit-msg** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–¥–ø–∏—Å—å:

Signed-off-by: jaCKdaniels ü•É jaCKdaniels@AgeToPerfect.ion

–ñ—É—Ä–Ω–∞–ª —Ä–∞–±–æ—Ç—ã —Ö—É–∫–æ–≤ –ø–∏—à–µ—Ç—Å—è –≤: `/root/wz-garry-bot/.husky.log`.

### –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç
```bash
git commit --allow-empty -m "test: hooks pipeline"


---

33. ESLint (flat config, v9+)

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: eslint.config.js (flat).
–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã:

eslint

@eslint/js

globals


–ò–≥–Ω–æ—Ä—ã: node_modules/**, .husky/**, deploy/*.enc.

–ó–∞–ø—É—Å–∫:

npx eslint . --ext .js


---

34. –ê–≤—Ç–æ–ø–æ–¥–ø–∏—Å—å –∫–æ–º–º–∏—Ç–æ–≤ (DCO-lite)

–•—É–∫ prepare-commit-msg –¥–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç—Ä–æ–∫—É:

Signed-off-by: jaCKdaniels ü•É <jaCKdaniels@AgeToPerfect.ion>

–¶–µ–ª—å ‚Äî –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–∞—è –∞—Ç—Ä–∏–±—É—Ü–∏—è –∞–≤—Ç–æ—Ä–∞ –∏ –∞—É–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π.


---

35. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ö—É–∫–æ–≤

–§–∞–π–ª: /root/wz-garry-bot/.husky.log
–°–æ–¥–µ—Ä–∂–∏—Ç —Ç–∞–π–º—Å—Ç–µ–º–ø—ã, –∞–≤—Ç–æ—Ä–∞ –∫–æ–º–º–∏—Ç–∞, —Ä–µ–∑—É–ª—å—Ç–∞—Ç ESLint/—Ç–µ—Å—Ç–æ–≤ –∏ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ –ø–æ–¥–ø–∏—Å–∏.

–ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–∞–ø–∏—Å–µ–π:

tail -n 50 /root/wz-garry-bot/.husky.log


---

36. –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ —Å–µ–∫—Ä–µ—Ç–∞—Ö

–ù–µ –∫–æ–º–º–∏—Ç–∏—Ç—å .env, *.enc, –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏.

–°–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ –≤ SOPS-—Ñ–∞–π–ª–∞—Ö, —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ ‚Äî –Ω–∞ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö.

–ü—Ä–∏–º–µ—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ ‚Äî –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã, —Ä–µ–∞–ª—å–Ω—ã–µ ‚Äî —Ç–æ–ª—å–∫–æ –≤ .env.



---

## 32. –ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–º–º–∏—Ç–æ–≤ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (Husky)
–í –ø—Ä–æ–µ–∫—Ç–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã git-—Ö—É–∫–∏ **Husky**:
- **pre-commit** –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ–ø–∞–¥–∞–Ω–∏–µ `.env`, `*.enc`, `keys.txt`, –∏—â–µ—Ç —Å–∏–≥–Ω–∞—Ç—É—Ä—ã —Ç–æ–∫–µ–Ω–æ–≤, –∑–∞–ø—É—Å–∫–∞–µ—Ç ESLint –∏ (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏) —Ç–µ—Å—Ç—ã.
- **prepare-commit-msg** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–¥–ø–∏—Å—å:

Signed-off-by: jaCKdaniels ü•É jaCKdaniels@AgeToPerfect.ion

–ñ—É—Ä–Ω–∞–ª —Ä–∞–±–æ—Ç—ã —Ö—É–∫–æ–≤ –ø–∏—à–µ—Ç—Å—è –≤: `/root/wz-garry-bot/.husky.log`.

### –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç
```bash
git commit --allow-empty -m "test: hooks pipeline"


---

33. ESLint (flat config, v9+)

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: eslint.config.js (flat).
–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã:

eslint

@eslint/js

globals


–ò–≥–Ω–æ—Ä—ã: node_modules/**, .husky/**, deploy/*.enc.

–ó–∞–ø—É—Å–∫:

npx eslint . --ext .js


---

34. –ê–≤—Ç–æ–ø–æ–¥–ø–∏—Å—å –∫–æ–º–º–∏—Ç–æ–≤ (DCO-lite)

–•—É–∫ prepare-commit-msg –¥–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç—Ä–æ–∫—É:

Signed-off-by: jaCKdaniels ü•É <jaCKdaniels@AgeToPerfect.ion>

–¶–µ–ª—å ‚Äî –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–∞—è –∞—Ç—Ä–∏–±—É—Ü–∏—è –∞–≤—Ç–æ—Ä–∞ –∏ –∞—É–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π.


---

35. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ö—É–∫–æ–≤

–§–∞–π–ª: /root/wz-garry-bot/.husky.log
–°–æ–¥–µ—Ä–∂–∏—Ç —Ç–∞–π–º—Å—Ç–µ–º–ø—ã, –∞–≤—Ç–æ—Ä–∞ –∫–æ–º–º–∏—Ç–∞, —Ä–µ–∑—É–ª—å—Ç–∞—Ç ESLint/—Ç–µ—Å—Ç–æ–≤ –∏ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ –ø–æ–¥–ø–∏—Å–∏.

–ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–∞–ø–∏—Å–µ–π:

tail -n 50 /root/wz-garry-bot/.husky.log


---

36. –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ —Å–µ–∫—Ä–µ—Ç–∞—Ö

–ù–µ –∫–æ–º–º–∏—Ç–∏—Ç—å .env, *.enc, –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏.

–°–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ –≤ SOPS-—Ñ–∞–π–ª–∞—Ö, —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ ‚Äî –Ω–∞ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö.

–ü—Ä–∏–º–µ—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ ‚Äî –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã, —Ä–µ–∞–ª—å–Ω—ã–µ ‚Äî —Ç–æ–ª—å–∫–æ –≤ .env.



---

## üß© Security & Husky Workflow

Husky –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∫–æ–º–º–∏—Ç–æ–º –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–æ–∫:

1. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤:**  
   –ù–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–∫–æ–º–º–∏—Ç–∏—Ç—å `.env`, `.enc` –∏–ª–∏ `keys.txt`.

2. **–ê–Ω—Ç–∏—É—Ç–µ—á–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤:**  
   –ü—Ä–æ–≤–µ—Ä—è–µ—Ç staged-—Ñ–∞–π–ª—ã –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å—Ç—Ä–æ–∫ –≤—Ä–æ–¥–µ `TOKEN=` –∏–ª–∏ –∫–ª—é—á–µ–π —Ñ–æ—Ä–º–∞—Ç–∞ `123456789:ABC...`.

3. **–õ–∏–Ω—Ç–µ—Ä:**  
   –ó–∞–ø—É—Å–∫–∞–µ—Ç `ESLint` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ JS-—Ñ–∞–π–ª–æ–≤.

4. **–¢–µ—Å—Ç—ã:**  
   –í—ã–ø–æ–ª–Ω—è–µ—Ç `npm test` (–µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å).

5. **–ê–≤—Ç–æ–ø–æ–¥–ø–∏—Å—å:**  
   –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç—Ä–æ–∫—É:

Signed-off-by: jaCKdaniels ü•É jaCKdaniels@AgeToPerfect.ion

üîí –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã —Ç–æ–∫–µ–Ω—ã ‚Äî –∫–æ–º–º–∏—Ç –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è.  
‚úÖ –ï—Å–ª–∏ –≤—Å—ë —á–∏—Å—Ç–æ ‚Äî Husky –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –∫–æ–º–º–∏—Ç.

